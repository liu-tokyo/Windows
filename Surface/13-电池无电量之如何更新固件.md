## 电池无电量之如何更新固件

> 没有电量是指，电池无法充电的情况。如果仅仅是电量低，充电到 40% 之后即可。  
> 实践验证：方法2 的 **“骗过”系统：强制电源模式**，表面可以正常安装固件，实际上还是被阻拦，在 设备管理器 内，显示固件存在问题。

这确实是一个令人头疼的“先有鸡还是先有蛋”的问题。Surface 设备为了防止在固件更新过程中因断电导致主板损坏（“变砖”），官方在底层设置了强制检测：**电池电量通常必须在 40% 以上且连接电源**才能开始更新。

如果你的电池已经彻底无法充电，可以尝试以下几种“绕过”或强制更新的方法：

------

### 1. 强制功率绕过法（最简单尝试）

有时候系统只是因为检测到“未在充电”而报错。

- 确保使用的是原装 **65W** 适配器（小功率充电器会直接被拦截）。
- 在关机状态下，同时按住 **音量上键 + 电源键** 至少 15 秒，进入 UEFI 界面。
- 在 UEFI 界面查看电池状态。如果在这里能看到电池图标（即使是 0%），尝试直接重启进入系统再次运行更新。

### 2. 终极方案：使用“跳过电池检查”指令

如果你已经下载了 `.msi` 格式的 Surface 驱动固件包，可以通过命令行尝试强制运行。

1. 从微软官网下载适用于 Pro 4 的 **[SurfacePro4_WM10_15063_1702002_0.msi](https://support.microsoft.com/zh-cn/surface/%E4%B8%8B%E8%BD%BD%E9%80%82%E7%94%A8%E4%BA%8E-surface-%E7%9A%84%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F%E5%92%8C%E5%9B%BA%E4%BB%B6-09bb2e09-2a4b-cb69-0951-078a7739e120#bkmk_update-manually)**（版本号依具体更新而定）。
2. 按 `Win + X` 选择 **终端（管理员）** 或 **命令提示符（管理员）**。
3. 输入以下指令（假设文件在下载文件夹中）： `msiexec /i "C:\路径\到\你的文件.msi" /qb` *注意：这种方法虽然能安装驱动，但涉及 UEFI/微型控制器的底层固件更新仍可能在重启阶段被系统硬件检测拦截。*

### 3. “骗过”系统：强制电源模式

有时候系统因为电池报废进入了降频或保护模式，你可以尝试：

1. 打开 **设备管理器**。
2. 展开 **电池** 选项。
3. 右键点击 **Microsoft ACPI 兼容的控制方法电池**，选择 **卸载设备**（别担心，重启后会自动装回）。
4. 保持电源线连接，不要重启，直接尝试运行固件更新程序。

### 4. 进入 UEFI 界面确认状态

有时候固件更新失败是因为 UEFI 层的挂起。

1. 关机后，按住 **音量上键** + **电源键** 进入 UEFI。
2. 检查 **Device** 选项卡，确认所有硬件（包括电池接口）都是开启状态。
3. 如果 UEFI 中显示电池图标带红叉，说明硬件连接已失效，软件层面很难强制刷新。

### 5. 修改注册表（风险较高）

如果以上都不行，可以通过修改注册表绕过“低电量不更新”的限制。**请谨慎操作：**

1. 按下 `Win + R`，输入 `regedit`。
2. 定位到：`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Orchestrator`（路径可能随版本微调）。
3. 寻找或新建一个名为 `LowBatteryThreshold` 的 **DWORD (32位)** 值。
4. 将数值数据设置为 `0`。
5. 重启并尝试更新。

### 6. 使用命令行强制安装（最有效）

不要通过 Windows Update 自动更新，而是直接调用驱动包的安装程序并附加“忽略电池”的参数。

1. **下载官方驱动包**：前往微软官网下载 Surface Pro 4 的 `.msi` 驱动安装包（文件名通常类似 `SurfacePro4_Win10_18362_19.091.24271.0.msi`）。
2. **以管理员身份打开命令提示符 (CMD)**：
   - 在搜索栏输入 `cmd`，右键点击“以管理员身份运行”。
3. **输入强制指令**： 假设你的下载文件在 `C:\Downloads`，输入以下命令（注意替换实际路径和文件名）： `msiexec /i "C:\路径\文件名.msi" IGNORE_BATTERY=1`   
   *注：部分版本的驱动包支持 `IGNORE_BATTERY` 或 `/f` 参数来跳过环境检测。*

### 7. 通过设备管理器手动更新（针对特定固件）

如果整个 MSI 包无法运行，你可以手动更新那个报错的特定固件节点：

1. 右键开始菜单 -> **设备管理器**。
2. 找到 **固件 (Firmware)** 节点并展开。
3. 你会看到带黄色感叹号的项目（通常是 `Surface UEFI` 或 `Surface System Aggregator`）。
4. 右键点击它 -> **更新驱动程序** -> **浏览我的电脑以查找驱动程序**。
5. 选择 **从计算机的可用驱动程序列表中选择**。
6. 点击 **从磁盘安装**，然后指向你解压驱动包后得到的 `.inf` 文件所在文件夹。

### 8. 解压 MSI 包后通过“设备管理器”点对点强制更新

这是绕过安装程序（Installer）环境检测最彻底的方法：

1. **解压驱动包**：
   - 下载 Surface Pro 4 的 `.msi` 驱动包。
   - 使用解压缩软件（如 7-Zip）右键点击 `.msi` 文件，选择“提取到文件夹”。
2. **定位固件文件**：
   - 在提取后的文件夹里，寻找 `Firmware` 文件夹。
   - 找到后缀名为 `.inf` 的文件（通常名为 `SurfacePro4_Uefi.inf` 或类似名称）。
3. **强制更新驱动节点**：
   - 右键桌面“此电脑” -> **管理** -> **设备管理器**。
   - 展开 **固件 (Firmware)**。
   - 右键点击带感叹号或显示 **Surface UEFI** 的项 -> **更新驱动程序**。
   - 选择 **“浏览我的电脑以查找驱动程序”** -> **“让我从计算机上的可用驱动程序列表中选择”**。
   - 点击右下角 **“从磁盘安装”**，然后指向刚才解压出来的那个 `.inf` 文件。
   - 忽略所有警告提示，强制安装。
4. **重启生效**：
   - 重启时，你会看到屏幕出现黑色背景和白色进度条，**此时千万不要碰到电源线**！

### 9. UEFI 强制识别模式

有时候通过重置电源状态可以暂时绕过检测：

1. **彻底关机**（长按电源键 20 秒直到屏幕黑掉）。
2. 同时按住 **音量上键 + 电源键**，直到看到 Surface 图标进入 UEFI 界面。
3. 在 UEFI 菜单中找到 **Device Information**，确认 Battery 状态。
4. 如果显示 "Battery not present" 或 "0%"，尝试在 UEFI 中切换 **"Battery Limit Mode"**（电池限制模式）的开关（先开启再关闭，或者先关闭再开启）。这有时能重置电源管理器的逻辑。
5. 退出并重启，进入系统后立即运行更新。

### ⑩. 通过组策略永久关闭驱动更新（专业版/企业版适用）

如果你使用的是 Win10/Win11 专业版，可以一劳永逸地禁止通过 Windows Update 更新驱动程序。

1. 按下 `Win + R`，输入 `gpedit.msc` 并回车。
2. 导航到：`计算机配置` > `管理模板` > `Windows 组件` > `Windows 更新`。
3. 在右侧找到 **“Windows 更新不包括驱动程序”** (Exclude drivers from Windows Quality Updates)。
4. 双击它，选择 **已启用**，点击确定。
5. **效果**：系统以后只会下载安全补丁，不再动你的固件和驱动。

------

### ⚠️ 风险警告

**固件更新本质上是在改写硬件的最底层指令。** 如果 Surface Pro 4 在更新过程中因为电源适配器松动或瞬间断电：

- **后果：** 你的 Surface 将彻底无法开机，只能通过专业维修店拆机烧录芯片，甚至报废。
- **建议：** 如果电池完全失效，建议先插拔电源接口几次，确保白色指示灯常亮。

### ⚠️硬件层面的 alternative（备选方案）

由于 Pro 4 是 2015 年的产品，电池膨胀或失效是通病。如果你是因为“电池 0%，接通未充电”导致性能极慢（CPU 锁频到 0.4GHz），更新固件其实无法解决硬件物理损毁。

### ⚠️ 核心警告

**Surface Pro 4 有一个著名的硬件缺陷：** 电池老化后容易膨胀（鼓包）。 如果你的屏幕边缘出现黄色斑点、屏幕被顶开或者触控失灵，这说明电池已经膨胀。在这种情况下，**绝对不要尝试强制更新固件**。固件更新会使 CPU 剧烈发热，可能会引发电池起火或爆炸。

**下一步建议：** 你的电池目前在任务栏显示的是“电源已接通，未在充电”还是直接显示“未检测到电池”？如果是后者，大概率是电池硬件彻底损坏，软件层面的强制更新可能无法生效。