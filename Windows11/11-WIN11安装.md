# Windows11 安装

> 旧版本升级 23H2 的时候，类似于系统升级，会产生旧系统的垃圾文件，大概 15GB 左右，注意应该删除。  
> 感觉 WIN11 要比 WIN10 重很多，老旧电脑还是采用 WIN10 比较好，尤其是用 机械硬盘 的老旧电脑。感觉 8GB 内存不能保证 WIN11 运行流畅。  
> 官方下载地址：https://www.microsoft.com/zh-cn/software-download/windows11



## 1. 系统全新安装

例如用 USB 安装，在无法继续的时候（最新的 24H2 需要提前导入，最后一步导入无用）：

- **[Shift + F10]** 启动 `命令提示符`

  输入`regedit`，启动注册表，修改如下注册表的数据（导入 `w11_inst.reg` 更方便）：

  ```plaintext
  Windows Registry Editor Version 5.00
  
  [HKEY_LOCAL_MACHINE\SYSTEM\Setup\LabConfig]
  "BypassTPMCheck"=dword:00000001
  "BypassSecureBootCheck"=dword:00000001
  "BypassRAMCheck"=dword:00000001
  ```

  保存为 `w11_inst.reg` 文件，在安装途中导入该文件。所有数值都是 `32位 DWORD`，如果用 `64位 DWORD`，则无法正确识别。

## 2. 使用本地用户

### 2.1 系统安装时刻

新版本的WIN11已经无法在安装的时候使用本地用户，需要如下操作才可以。

1. 显示网络连接画面的时候，按下 `Shift+F10`，会弹出命令提示符画面。
2. 命令提示符画面，输入 `oobe\bypassnro.cmd`，稍等会重新启动电脑。
    注意：23H2 版本 是 `oobe\BypassNRO.cmd` ,并且区分大小写，需要输入正确才可以。
3. 重启后，到网络连接画面，就会显示 `我没有Internet连接` 项目，点击就可以使用本地用户登录。

注意；初期不要输入密码，否则需要回答安全选项，等电脑正常登录之后，重新设置密码。

### 2.2 切换本地用户

系统安装之后，可以切换本地用户。

- `设置` → `账户` → `账户信息`， 在 `账户设置` 找到 `Microsoft账户` 的右侧应该有 `改用本地账户` 的项目。
   系统可能会要求您验证身份，输入您的Microsoft账户密码以确认身份。
- 设置本地账户
   在切换到本地账户后，系统会要求您设置一个本地账户。输入所需的用户名、密码和密码提示信息。

完成上述步骤后，您的Windows 11操作系统将从Microsoft账户切换为本地账户。
 ※ 请注意，具体步骤可能会根据`Windows 11`的版本和更新而有所不同。如果上述步骤在您的系统中不适用，建议查阅最新的`Windows 11`操作系统文档或联系您组织的IT支持团队以获取准确的指导。

## 3. 系统通用设置

### 3.1 关闭天气小组件

- `任务栏设置` → `个性化` → `任务栏` 画面的 `任务栏项` → `小组件`，关闭该项目即可。

### 3.2 任务栏图标展开 

- `系统设置` → `个性化` → `任务栏` → `合并任务栏按钮并隐藏标签`，选项选择“从不”。



## 磁盘清理

‌在Windows 11中，可以通过以下几种方法找到磁盘清理工具‌：

- ‌通过开始菜单或搜索栏‌：按下Win键或点击任务栏上的开始图标，然后在搜索栏中输入 `磁盘清理` 即可找到并打开该工具。‌


- ‌通过运行对话框‌：按下Win+R键，输入 `cleanmgr` 命令，然后按Enter键即可启动磁盘清理工具。‌


- ‌通过控制面板‌：打开控制面板，选择`系统和安全`，然后找到 `管理工具` 部分，点击 `释放磁盘空间` 选项来启动磁盘清理。‌

磁盘清理工具的功能和操作步骤‌：

- ‌清理临时文件‌：在设置中进入系统存储选项，选择C盘并点击 `临时文件` 选项，系统会显示可删除的临时文件列表，点击 `删除临时文件` 按钮即可清理。‌


- ‌手动选择文件进行清理‌：在磁盘属性窗口中，系统会列出可以删除的文件类型，如 `下载文件`、 `回收站` 、`临时文件` 等，用户可以根据需要选择并删除这些文件。‌


通过这些方法，用户可以轻松找到并使用Windows 11中的磁盘清理工具，释放磁盘空间，提升系统性能。



# 安装过程详细

## 1. 系统安装

使用 `EasyU（优启通）` 作业比较简单。

## 2. 初次启动

- 安装之后，初次启动进入 `地区` 选择画面的时候，按下 `Shift+F10` ，启动 `命令提示符`，输入如下指令：

  ```powershell
  cd oobe
  ByPassNRO.cmd
  ```

  重新启动电脑，安装没有网络的设置。

- 网络选择画面  
  选择 `我没有 Internet 连接`，这样就可以输入 `用户名` 的方式，不需要安装邮件登录的方式登陆系统。  
  ※ 注意：不要输入口令，否则比较麻烦。可以在电脑正常启动之后，再设置口令比较合理。

## 3. 初始设置

首先把 `设置` 固定到 `任务栏`，方便之后的操作。

### 3.1 设置远程桌面

方便远程操作方便。

### 3.2 输入方式选择

选择输入法默认模式为 `英语`，原始默认为 `中文`。

### 3.3 用户数据转移

- 在 D盘，新建 `VIP_DATA` 子目录，把用户数据的下载、文档、图片、视频、音乐等用户数据目录转移到该目录下面；

### 3.4 缓存数据转移

在 D盘，新建 `VIP_TEMP` 子目录，用于保存各种缓存数据。

- 用户缓存数据  
  新建 `D:\VIP_TEMP\UserTemp` 目录，把 `用户变量` 的 `TEMP` 和 `TMP` 的值，修改为 `D:\VIP_TEMP\UserTemp`；

- 系统缓存数据  
  新建 `D:\VIP_TEMP\SysTemp` 目录，把 `系统变量` 的 `TEMP` 和 `TMP` 的值，修改为 `D:\VIP_TEMP\SysTemp`；

- 浏览器缓存转移（EDGE）

  - 关闭所有 EDGE 的实例

    ```powershell
    taskkill /F /IM msedge.exe
    ```

  - 删除如下目录的 `Cache` 子目录

    ```powershell
    C:\Users\%username%\AppData\Local\Microsoft\Edge\User Data\Default\
    ```

  - 创建符号链接

    创建 `D:\VIP_TEMP\EdgeCache` 目录，然后启动 `命令提示符（管理员权限）` 输入如下指令：

    ```powershell
    mklink /D "C:\Users\%username%\AppData\Local\Microsoft\Edge\User Data\Default\Cache" "D:\VIP_TEMP\EdgeCache"
    ```

- 浏览器缓存转移（CHROME）

  - 关闭所有 CHROME 的实例

    ```powershell
    taskkill /F /IM chrome.exe
    ```

  - 删除如下目录的 `Cache` 子目录

    ```powershell
    C:\Users\%username%\AppData\Local\Google\Chrome\User Data\Default\
    ```

  - 创建符号链接

    创建 `D:\VIP_TEMP\ChromeCache` 目录，然后启动 `命令提示符（管理员权限）` 输入如下指令：

    ```powershell
    mklink /D "C:\Users\%username%\AppData\Local\Google\Chrome\User Data\Default\Cache" "D:\VIP_TEMP\ChromeCache"
    ```

### 3.5 更新 winget

- 升级所有 winget 的软件

  ```powershell
  winget upgrade --all
  ```

- 安装常用软件

  ```powershell
  winget install 7zip.7zip
  ```

### 3.6 虚拟内存转移

- 把系统的虚拟内存转移到 D分区。

## 4. 驱动更新

### 4.1 Intel驱动更新

- 主板驱动更新  
  下载、安装 `Intel inf utility`。
- Intel驱动助手  
  下载、安装 `intel driver support assistant`，然后执行驱动更新。

### 4.2 厂家驱动更新

- 联想电脑  
  安装 `lenovo system update`，这是一个比较旧的更新工具，针对大部分旧电脑有效。针对相对较新的联想电脑，可以安装 `联想电脑管家`，海外是 `Lenovo Vantage` 或 `Lenovo PC Manager`。

## 5. 系统更新

## 6. MsOffce安装

## 7. 磁盘垃圾清理

- DISM++
- Windows11自带的 `磁盘清理`
- 浏览器缓存清除

