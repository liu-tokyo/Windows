# 如何减少内存占用

## 综合处理

### 1. 服务

- 搜索框输入 `services.msc` 并回车确定，处理如下服务：

  | 服务名称                                     | 建议操作      | 说明（理由）                                                 |
  | -------------------------------------------- | ------------- | ------------------------------------------------------------ |
  | **Connected User Experiences and Telemetry** | **禁用**      | 臭名昭著的“遥测”服务，后台持续上传系统使用数据。             |
  | **Downloaded Maps Manager**                  | **禁用**      | （服务名称为 `MapsBroker`）是 Windows 系统中专门负责管理**离线地图**的服务。 |
  | **SysMain (原 Superfetch)**                  | **禁用/手动** | 针对机械盘优化的预加载，对 SSD 意义不大且容易导致 CPU 瞬间满载。 |
  | **Windows Search**                           | **手动**      | 如果你很少用开始菜单搜本地文件，关掉它能节省大量后台索引开销。 |
  | **Microsoft Edge Update Service**            | **禁用**      | 除非你天天用 Edge 且强迫症要最新版，否则没必要让它在后台待命。 |
  | **Print Spooler**                            | **禁用/手动** | 如果你不接打印机，这个服务纯属浪费。                         |
  | **Windows Image Acquisition (WIA)**          | **禁用**      | 如果你不接扫描仪。                                           |

  

### 2. 设置

- 利用系统设置，关闭不必要的项目

  | 项目名称             | 位置                                                         | 建议操作 | 说明（理由）                                                 |
  | -------------------- | ------------------------------------------------------------ | -------- | ------------------------------------------------------------ |
  | **通知**             | `设置 → 系统 → 通知 → 通知`                                  | 关闭     |                                                              |
  | **请勿打扰**         | `设置 → 系统 → 通知 → 请勿打扰`                              | 开启     |                                                              |
  | **存储感知**         | `设置 → 系统 → 存储 → 存储感知`                              | 开启     |                                                              |
  | **透明效果**         | `设置 → 个性化 → 颜色 → 透明效果`                            | 关闭     | 渲染透明毛玻璃效果时会占用不少 GPU 资源，关闭后窗口拖动会更顺滑。 |
  | **小组件 (Widgets)** | `设置 → 个性化 → 任务栏 → 小组件`                            | 关闭     | Windows 11 的 Widgets 是个内存大户。                         |
  | **发送可选诊断数据** | `设置 → 隐私和安全性 → 发送可选诊断数据`                     | 关闭     | 让系统少干点“偷窥”的活                                       |
  | **量身定制的体验**   | `设置 → 隐私和安全性 → 量身定制的体验`                       | 关闭     |                                                              |
  | **在历史记录中搜搜** | `设置 → 隐私和安全性 → 搜索 → 在历史记录中搜搜`              | 关闭     |                                                              |
  | **显示搜索要点**     | `设置 → 隐私和安全性 → 搜索 → 显示搜索要点`                  | 关闭     | 点击搜索框的时候，不显示网络内容，仅显示本地内容。           |
  | **个性化广告**       | `设置 → 隐私和安全性 → 常规`                                 | 关闭     |                                                              |
  | **内核隔离**         | `设置 → 隐私和安全性 → Windows 安全中心 → 设备安全性 → 内核隔离` | 关闭     | VBS (基于虚拟化的安全性)，这是 Win11 拖慢老 CPU 性能的元凶之一。 |
  | **传递优化**         | `设置 → Windows 更新 → 高级选项 → 传递优化`                  | 关闭     |                                                              |
  
  

### 3. 组策略

- 搜索框输入 **`gpedit.msc`**，并回车确定，处理如下项目：

  | 策略位置                                                     | 项目                                     | 建议操作   | 说明（理由）                          |
  | ------------------------------------------------------------ | ---------------------------------------- | ---------- | ------------------------------------- |
  | 计算机配置 → 管理模板 → Windows 组件 → 数据收集和预览版      | **允许诊断数据**                         | **已禁用** | Connected User Experiences 相关       |
  | 用户配置 → 管理模板 → Windows 组件 → 搜索                    | **不允许 Web 搜索**                      | **已启用** | 禁用 Bing 网络结果（Web Search）      |
  | 〃                                                           | **请勿在 Web 搜索中搜索或显示 Web 结果** | **已启用** | 〃                                    |
  | 计算机配置 → 管理模板 → Windows 组件 → OneDrive              | **禁止使用 OneDrive 进行文件存储**       | **已启用** | 彻底禁止 OneDrive                     |
  | 计算机配置 → 管理模板 → Windows 组件 → Windows 更新 → 管理最终用户体验 | **配置自动更新**                         | **已禁用** | 关闭 Windows 更新，比关闭服务更稳妥。 |
  
  

### 4. `Winget`指令

使用系统自带的 `winget` 指令，下载不需要的组件。打开 **命令提示符（管理者）** 执行如下的指令：

- 天气组件

  ```
  winget uninstall "Windows web experience pack"
  ```

- XBox关联组件

  ```
  winget uninstall "Xbox TCUI"
  winget uninstall "Game Bar"
  winget uninstall "Xbox Identity Provider"
  winget uninstall "Game Speech Window"
  winget uninstall "Xbox"
  ```
  
- 其它全部的操作

  ```
  winget uninstall "Cortana"
  winget uninstall "MSN 天气"
  winget uninstall "获取帮助"
  winget uninstall "Microsoft 使用技巧"
  winget uninstall "画图 3D"
  winget uninstall "3D 查看器"
  winget uninstall "Office"
  winget uninstall "Microsoft Solitaire Collection"
  winget uninstall "Microsoft Sticky Notes"
  winget uninstall "混合现实门户"
  winget uninstall "OneNote"
  winget uninstall "Microsoft 人脉"
  winget uninstall "Skype"
  winget uninstall "Microsoft Pay"
  winget uninstall "Microsoft 照片"
  winget uninstall "Windows 闹钟和时钟"
  winget uninstall "Windows 计算器"
  winget uninstall "Windows 相机"
  winget uninstall "反馈中心"
  winget uninstall "Windows 地图"
  winget uninstall "Windows 录音机"
  winget uninstall "Xbox TCUI"
  winget uninstall "Xbox"
  winget uninstall "Xbox Game Bar Plugin"
  winget uninstall "Xbox Game Bar "
  winget uninstall "Xbox Identity Provider"
  winget uninstall "Xbox Game Speech Window"
  winget uninstall "你的手机"
  winget uninstall "Groove 音乐"
  winget uninstall "电影和电视"
  
  ```

  

### 5. 注册表

- 搜索框输入 **`regedit`**，并回车确定，处理如下项目：

  | 位置                                                         | 项目                             | 类型          | 数值 | 说明（理由）                                     |
  | ------------------------------------------------------------ | -------------------------------- | ------------- | ---- | ------------------------------------------------ |
  | HKEY_CLASSES_ROOT\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6} | `System.IsPinnedToNameSpaceTree` | DWORD (32 位) | 0    | 禁止 OneDrive<br />※（卸载后一般已消失，如还在） |
  | HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Search | `BingSearchEnabled`              | DWORD (32 位) | 0    | 禁用 Bing                                        |
  | 〃                                                           | `ConnectedSearchUseWeb`          | DWORD (32 位) | 0    | 〃                                               |

  

### 6. 其它操作

- 画面特效（如果你觉得窗口切换不够丝滑，可以牺牲一点美感换速度）

  搜索框内输入 `调整 Windows 的外观和性能`，选择 **“调整为最佳性能”**，然后仅勾选 **“平滑屏幕字体边缘”**（防止文字模糊）。这会让系统操作感觉快起飞。

- 卸载 OneDrive

  ```cmd
  taskkill /f /im OneDrive.exe
  %SystemRoot%\System32\OneDriveSetup.exe /uninstall
  ```

  如果是 32 位 OneDrive

  ```cmd
  %SystemRoot%\SysWOW64\OneDriveSetup.exe /uninstall
  ```

  删除残留文件夹

  ```cmd
  rd "%UserProfile%\OneDrive" /s /q
  rd "%LocalAppData%\Microsoft\OneDrive" /s /q
  rd "%ProgramData%\Microsoft OneDrive" /s /q
  ```

- 停用磁盘整理计划  
  SSD的话，几乎不需要磁盘整理；  
  HDD的话，一旦开始磁盘整理，电脑就完全无法操作；最好是人工手动、在空闲的时候整理磁盘更好。或者是使用 DiskGenius 等磁盘工具对分区进行备份，然后再还原，就更加彻底了。



## 1. 天气组件

- 细看还真是不少占用内存，使用如下指令卸载该组件（普通人一般也不会在这里看天气，手机看更方便）：  

  ```powershell
  winget uninstall "Windows web experience pack"
  ```

  ※比较恶心的是，虽然在任务栏管理，关闭了天气组件，依然还在后台占用内存。

  ※该指令下载所有和 `WebView2` 相关的组件，天气、新闻等，都依赖 `WebView2`。

- 内存占用对比

  | **状态**            | **内存占用情况** | **对系统影响**                                |
  | ------------------- | ---------------- | --------------------------------------------- |
  | **开启状态**        | 约 300MB - 1GB+  | 持续占用，由于新闻流更新可能导致后台 CPU 波动 |
  | **仅隐藏 (方法一)** | 约 50MB - 100MB  | 显著降低占用，但仍有残留进程                  |
  | **彻底卸载/禁用**   | **0 MB**         | 彻底释放资源，系统启动略微加快                |

## 2. 搜索亮点

关闭 Windows 11 搜索框里的“搜索亮点”（即搜索窗口右侧出现的每日插画、热门新闻和节日提醒）

### 2.1 通过“设置”关闭（最推荐）

这是官方提供的标准方法，操作直观：

1. 按下键盘上的 **`Win + I`** 组合键打开 **设置**。
2. 在左侧菜单栏中点击 **隐私和安全性**。
3. 在右侧列表中找到并点击 **搜索权限**。
4. 向下滑动到页面底部，找到“更多设置”板块。
5. 将 **显示搜索亮点** 的开关拨至 **关闭**。

※新版本 Windows11(25H2) 实操，已经发生变化，该方法不可用。

### 2.2 直接从任务栏进入

如果你想快速跳转，也可以这样做：

1. 点击任务栏上的 **搜索框** 或 **搜索图标**。
2. 在弹出的搜索窗口右上角，点击 **三个点（...）** 菜单。
3. 选择 **搜索设置**，这会直接带你进入方案一中的设置界面。
4. 关闭 **显示搜索亮点**。

※实操该方法可用。

### 💡 关闭后的变化

- **视觉效果：** 点击搜索框后，右侧不再显示杂乱的新闻和图片，只会显示你最近使用的应用和频繁搜索的项目。
- **性能提升：** 减少了后台加载图片和新闻资讯的流量及内存占用。
- **搜索框图标：** 任务栏搜索框右侧那个代表当天节日的小图标也会消失，恢复成纯净的搜索框。

## 3. Windows Search

在 Windows 11 中，“关闭 Windows Search”通常有两种不同的需求：一种是**隐藏任务栏的搜索框**（为了美观），另一种是**彻底禁用搜索索引服务**（为了省电、省硬盘占用）。

### 3.1. 仅仅隐藏任务栏搜索框 (推荐)

如果你只是觉得搜索框占位置，并不想破坏系统功能，这是最优雅的做法：

1. 在任务栏空白处 **右键点击**。
2. 选择 **任务栏设置**。
3. 在“任务栏项”中找到 **搜索**。
4. 在下拉菜单里选择 **隐藏**。
   - *提示：即使隐藏了，你依然可以随时按 `Win` 键直接打字进行搜索，效果是一样的。*

### 3.2. 彻底禁用搜索索引服务 (慎重选择)

如果你觉得 `SearchIndexer.exe` 进程占用了太多的 CPU 或磁盘 IO，想彻底关掉它，请注意：**关闭后，搜索本地文件会变得极其缓慢。**

1. 按下 `Win + R`，输入 `services.msc` 并回车。
2. 在服务列表中找到 **Windows Search**。
3. **右键点击** 它，选择 **属性**。
4. 将“启动类型”改为 **禁用**。
5. 点击 **停止** 按钮，然后点击确定。

### 3.3. 如果因为`搜索太慢`或`搜不到东西`

有时候关闭它是因为它不好用。其实你可以通过优化让它变好用，而不是直接杀掉它：

- **只索引特定文件夹：** 进入 `设置 > 隐私和安全性 > 搜索 Windows`，在这里你可以选择“经典”模式，并排除掉那些包含成千上万个小文件的文件夹（比如代码库或游戏目录），这样可以极大缓解 CPU 占用。

### 💡 建议

如果你彻底禁用了 Windows Search 索引服务，我强烈建议你下载一个仅有几 MB 大小的神器：**Everything**。

- **对比：** Windows 原生搜索会预先读取文件内容（导致卡顿）；而 Everything 只读取文件名称。
- **结果：** Everything 几乎不占内存和 CPU，且搜索文件是**瞬间**完成的。



## 4. Xbox Services

Xbox Services（Xbox 相关服务）主要为游戏玩家提供成就同步、联机互动和商店支持。如果你**从不玩游戏**，关闭这些服务可以释放一些系统资源。

### 4.1 禁用服务（最稳妥，可随时恢复）

这种方法不会删除文件，只是让这些服务不再随开机自动运行。

1. 按下 **`Win + R`**，输入 **`services.msc`** 并回车。
2. 滚动到列表最底部，你会看到以下几个以 **Xbox** 开头标项：
   - **Xbox Accessory Management Service** (配件管理)
   - **Xbox Live Auth Manager** (身份验证)
   - **Xbox Live Game Save** (游戏存档同步)
   - **Xbox Live Networking Service** (网络服务)
3. 对其中的每一项执行以下操作：
   - **右键点击** -> **属性**。
   - 将“启动类型”改为 **禁用**。
   - 点击 **停止**（如果服务正在运行）。
4. 点击确定并**重启电脑**。

### 4.2 通过 PowerShell 彻底卸载应用

如果你想做得更绝，直接把系统预装的 Xbox 关联应用删掉，可以使用命令：

1. 右键点击“开始”按钮，选择 **终端 (管理员)** 或 **PowerShell (管理员)**。

2. 输入并运行以下命令：

   ```PowerShell
   Get-AppxPackage *xboxapp* | Remove-AppxPackage
   ```
   
   *这会卸载主程序。如果想清理所有关联项，可以接着运行：*

   ```PowerShell
   Get-AppxPackage *xbox* | Remove-AppxPackage
   ```

   ※*这个指令执行失败，不明是什么原有你。*

### 4.3 通过 winget 彻底卸载应用

- 命令提示符 或 PowerShell 输入如下指令：

  ```
  winget uninstall "Xbox TCUI"
  winget uninstall "Game Bar"
  winget uninstall "Xbox Identity Provider"
  winget uninstall "Game Speech Window"
  winget uninstall "Xbox"
  ```

### 💡 注意事项

- **游戏党慎用：** 如果你以后想玩《极限竞速：地平线》或其他 Xbox Game Pass (XGP) 游戏，必须重新开启这些服务并安装应用，否则无法登录账号或同步存档。
- **Game Bar：** 卸载后，快捷键 `Win + G`（录屏/性能监控）也将失效。

如果你只是偶尔觉得它烦，**方法一（禁用）** 是性价比最高的方案。它切断了后台连接，又留下了后悔药。



## 5. Fax

在 Windows 11 中，**Fax（传真）** 服务是一个年代久远的遗留功能。如果你家里或办公室没有连接实体传真机，这个服务完全是多余的。

### 5.1 禁用 Fax 后台服务

这能防止系统在后台为传真功能预留资源。

1. 按下 **`Win + R`**，输入 **`services.msc`** 并回车。
2. 在列表中找到 **Fax**。
3. **右键点击** 它，选择 **属性**。
4. 将“启动类型”更改为 **禁用**。
5. 如果服务正在运行，点击 **停止**，然后点击确定。

### 5.2 移除“传真和扫描”可选功能

※ 彻底清理

Windows 将传真视为一个可选的组件，你可以直接从系统功能库中将其移除，这样它就不会出现在你的应用列表里了。

1. 按下 **`Win + I`** 打开 **设置**。
2. 依次进入 **应用** > **可选功能**。
3. 在“已安装的功能”列表中，搜索 **Windows 传真和扫描**。
4. 点击其右侧的下拉箭头，选择 **卸载**。

### 5.3 关闭“打印到传真”虚拟打印机

如果你在打印文档时，经常在打印机列表里看到一个叫 **Fax** 的选项，觉得碍眼，可以将其删除：

1. 在 **设置** 中进入 **蓝牙和其他设备** > **打印机和扫描仪**。
2. 找到名为 **Fax** 的图标。
3. 点击进入并选择 **删除**。

### 💡 深度优化建议

既然你已经在清理这些过时的老旧功能了，还有一个类似的服务叫做 **Print Spooler**（打印后台处理）：

- 如果你**家里完全没有打印机**，也可以按照方法 1 的步骤把 **Print Spooler** 禁用了。这能减少系统对打印机状态的持续轮询，让后台更干净。

## 6. Connected User Experiences

在 Windows 11 中，**Connected User Experiences and Telemetry**（连接用户体验和遥测）是负责收集诊断数据并发送给微软的服务。如果你出于隐私或节省系统资源的考虑可以关闭它。

### 6.1 通过“服务”管理器（最常用、最直接）

这是最简单的图形化操作方法：

1. 按下 `Win + R` 键，输入 **`services.msc`**，点击确定。
2. 在服务列表中找到 **`Connected User Experiences and Telemetry`**。
3. **右键点击**它，选择 **“属性”**。
4. 在“常规”选项卡中：
   - 将 **“启动类型”** 设置为 **“禁用”**。
   - 如果该服务正在运行，点击 **“停止”** 按钮。
5. 点击“确定”保存设置。

### 6.2 通过命令行（CMD/PowerShell）

如果你喜欢快速操作，可以以管理员身份运行命令：

1. 按下 `Win + S` 搜索 **CMD**，右键点击“以管理员身份运行”。

2. 输入以下两条命令（每行回车）：

   ```
   sc config DiagTrack start= disabled
   sc stop DiagTrack
   ```

### 6.3 通过组策略编辑器

> 适用于专业版/企业版

这种方法可以从策略层面强制禁止数据收集：

1. 按下 `Win + R`，输入 **`gpedit.msc`**，点击确定。
2. 导航到以下路径： `计算机配置` > `管理模板` > `Windows 组件` > `数据收集和预览版`
3. 在右侧双击 **“允许诊断数据”** (在旧版本中可能叫“允许遥测”)。
4. 选择 **“已禁用”**，然后点击“确定”。

### 💡 补充隐私设置建议

关闭该服务后，建议你也检查一下 Windows 设置中的相关开关：

1. 打开 **设置** > **隐私和安全性** > **诊断和反馈**。
2. 关闭 **“发送可选诊断数据”**。
3. 关闭 **“量身定制的体验”**。

> [!TIP] **温馨提示** 关闭此服务通常不会影响系统的基本稳定性，但可能会导致你无法收到某些特定的 Windows 预览体验计划更新，或者无法使用某些基于用户反馈的“个性化”功能。

## 7. 古董功能和后台服务

Windows 11 为了兼容性，确实保留了大量普通用户根本用不到的“古董”功能和后台服务。如果你追求极简和极致性能，以下是除了 Fax 和 Xbox 之外，你可以安全关闭或禁用的老旧/冗余功能。

### 7.1  遗留的老旧组件（Windows 功能）

按下 `Win + R` 输入 `optionalfeatures` 即可看到这些开关。

- **Internet Explorer 11：** 现在的 IE 已经完全被 Edge 取代，可以直接关掉。
- **Legacy Components (旧版组件) -> DirectPlay：** 这是为 2000 年左右的老游戏设计的。如果你不玩《帝国时代 2》原版等极老的游戏，建议关闭。
- **远程差分压缩 API 支持：** 用于比较同步文件的古老技术，现代软件基本不用，关闭后可略微提升文件操作效率。
- **Windows 媒体功能（如果不用 WMP）：** 如果你习惯用 PotPlayer 或 VLC，可以卸载自带的 Windows Media Player。

### 7.2 冗余的后台服务（Services.msc）

按下 `Win + R` 输入 `services.msc`，找到以下项并设为**禁用**：

- **Connected User Experiences and Telemetry (连接用户体验和遥测)：** 这是最大的“间谍”进程，负责收集数据发给微软，禁用它能提升隐私并减少后台 CPU 占用。
- **Downloaded Maps Manager (下载的地图管理器)：** 如果你不用 Windows 自带的离线地图应用，可以关掉。
- **Touch Keyboard and Handwriting Panel Service (触摸键盘和手写面板)：** 如果你是台式机且没有触摸屏，这个服务完全没用。
- **Geolocation Service (地理位置服务)：** 如果你不需要系统自动判断你的时区或在网页里精确定位，可以禁用。
- **Print Spooler (打印后台处理)：** **前提是你家里和公司都没有打印机**。禁用它能直接切断所有打印相关的后台轮询。

### 7.3 系统内置的“牛皮藓”功能

在“设置”中可以关闭这些干扰项：

- **传递优化 (Delivery Optimization)：** * *路径：* 设置 > Windows 更新 > 高级选项 > 传递优化。
  - *作用：* 它会让你的电脑变成局域网内的“下载站”，把补丁发给别人。关闭它可以节省上传带宽。
- **搜索中的“网络结果”：**
  - Windows 搜索时经常会带出 Bing 的网页结果，导致搜索本地文件变慢。这个通常需要修改注册表关闭，能极大提升搜索响应速度。
- **诊断数据：**
  - *路径：* 设置 > 隐私和安全性 > 诊断和反馈。
  - *作用：* 关闭“发送可选诊断数据”，让系统少干点“偷窥”的活。

### 7.4 视觉层面的“虚荣”特效

如果你觉得窗口切换不够丝滑，可以牺牲一点美感换速度：

- 按下 `Win + S` 搜 **“调整 Windows 的外观和性能”**。
- 选择 **“调整为最佳性能”**，然后仅勾选 **“平滑屏幕字体边缘”**（防止文字模糊）。这会让系统操作感觉快起飞。



**安全提醒：** 在进行大规模禁用前，建议先创建一个**系统还原点**。这样万一关错了某个你需要的特殊功能（比如关了蓝牙服务发现鼠标动不了了），可以一键救回。



## 8. EDGE浏览器

### 8.1 开启“效率模式”与“标签页休眠” (核心手段)

这是 Edge 最强大的原生优化功能。

- **路径：** 设置 -> 系统和性能。
- **操作：**
  - 开启 **“效率模式”**：这会自动限制非活动标签页的资源占用。
  - 开启 **“使用标签页休眠功能节约资源”**：将休眠时间设为 **5 分钟**或更短。
  - 开启 **“淡出休眠标签页”**：这样你能一眼看出哪些标签页被暂时“冻结”了。

### 8.2 关闭“启动增强”和“后台运行”

为了让你秒开浏览器，Edge 默认会在后台常驻进程，这会白白占用几百 MB 内存。

- **路径：** 设置 -> 系统和性能。
- **操作：**
  - 关闭 **“启动增强”**。
  - 关闭 **“在 Microsoft Edge 关闭后继续运行后台扩展和应用”**。

### 8.3 使用 Edge 内置的“浏览器任务管理器”

有时候不是 Edge 的错，而是某个网页脚本出 BUG 了。

- **快捷键：** `Shift + Esc`
- **操作：** 打开后你可以看到哪个标签页或插件最占内存。遇到内存占用大户（比如某些广告漫天飞的咨询网站），直接在这里结束进程。

### 8.4 精简扩展程序 (Extensions)

每个插件（如油猴、翻译、各种助手）都会开启独立的进程。

- **建议：** 禁用不常用的插件，或者用 **uBlock Origin** 替代其他繁重的广告拦截器。uBlock 对系统资源的占用是同类中最低的。

### 8.5 清理“侧边栏”和没用的服务

Edge 的侧边栏和自带的购物、优惠券功能都在偷偷耗电和内存。

- **路径：** 设置 -> 侧边栏。
- **操作：** 尽可能关闭侧边栏应用，特别是 Copilot（如果你此时不需要它）。

------

### 进阶黑科技：限制进程合并

如果你发现 Edge 进程开得太多（几十个），可以在 Edge 的桌面快捷键右键属性，在“目标”栏的最后添加以下参数（注意前面有一个空格）： ` --renderer-process-limit=3`

> **作用：** 强制浏览器合并渲染进程。虽然会牺牲一点稳定性，但在 8GB 内存的机器上能显著减少总进程数。



## 9. 内存完整性（HVCI）

- 如果是 8GB 以上内存，强烈建议：关闭内存完整性（HVCI）  

  ```
  Windows 安全 → 设备安全 → 内核隔离 → 内存完整性 → 关
  ```

  ※ 可省 **300～500MB**

## A. 老旧 CPU

不建议开：

- VBS
- Hyper-V
- 虚拟机平台

```
控制面板 → 启用或关闭 Windows 功能
```

## B. 禁用 Bing

在 Windows 11 的搜索栏中禁用 Bing 网络结果（Web Search）非常重要，特别是对于**机械硬盘**用户，因为这能显著减少网络请求带来的卡顿，让搜索回归“本地文件搜索”。

### B.1 通过注册表关闭（最有效）

1. 按下 **`Win + R`**，输入 **`regedit`** 并回车，打开注册表编辑器。
2. 在上方地址栏直接粘贴以下路径并回车： `计算机\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Search`
3. 在右侧空白处 **右键点击** -> **新建** -> **DWORD (32 位) 值**。
4. 将该新建值命名为：**`BingSearchEnabled`**。
5. 双击它，确保它的“数值数据”为 **`0`**（默认就是 0）。
6. 再次在空白处 **右键点击** -> **新建** -> **DWORD (32 位) 值**。
   - 命名为：**`ConnectedSearchUseWeb`**。
   - 数值数据同样保持为 **`0`**。
7. **重启电脑** 或者在任务管理器中重启 **“Windows 资源管理器”**。

### B.2 通过组策略关闭

> （仅限专业版/企业版）

如果你使用的是 Windows 11 专业版，这个方法更直观：

1. 按下 **`Win + R`**，输入 **`gpedit.msc`** 并回车。
2. 依次进入：**用户配置 > 管理模板 > Windows 组件 > 搜索**。
3. 在右侧找到以下两项：
   - **“不允许 Web 搜索”**：双击并设置为 **已启用**。
   - **“请勿在 Web 搜索中搜索或显示 Web 结果”**：双击并设置为 **已启用**。
4. 点击确定并重启。

### 💡 修改后的效果

- **速度变快：** 搜索时不再转圈去联想 Bing 的词条，瞬间显示本地结果。
- **界面整洁：** 搜索结果中不再出现“来自 Web 的结果”或无关的网页新闻。
- **专注本地：** 只会搜到你电脑里的应用、设置和文件。

### 💡 针对机械硬盘的额外叮嘱

由于你使用的是机械硬盘，在做完上述操作后，点击搜索框可能还会有一点点延迟，那是系统在读取搜索历史图标。如果你想更彻底一点，建议回到 **设置 > 隐私和安全性 > 搜索权限**，把 **“在此设备上搜索历史记录”** 也关掉。

**操作完成后，你可以试着在搜索框打几个字，是不是感觉响应速度比之前那个“带网络预览”的版本快多了？**

## C. OneDrive

### C.1 卸载软件

- 方法1：正常卸载  
  ```
  设置 → 应用 → 已安装的应用
  ```

  找到 Microsoft OneDrive → 卸载
  
  👉 适合 Win11 23H2 / 新装系统
  👉 卸载后不会影响系统更新

- 命令行卸载（更彻底，推荐）

  > PowerShell（管理员） 

  ```powershell
  taskkill /f /im OneDrive.exe
  %SystemRoot%\System32\OneDriveSetup.exe /uninstall
  ```

  如果是 32 位 OneDrive

  ```powershell
  %SystemRoot%\SysWOW64\OneDriveSetup.exe /uninstall
  ```

### C.2 清除痕迹

- 删除残留文件夹

  ```powershell
  rd "%UserProfile%\OneDrive" /s /q
  rd "%LocalAppData%\Microsoft\OneDrive" /s /q
  rd "%ProgramData%\Microsoft OneDrive" /s /q
  ```

- 去掉资源管理器左侧 OneDrive

  ```
  HKEY_CLASSES_ROOT\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}
  ```

  设置 `System.IsPinnedToNameSpaceTree = 0`

  ※（卸载后一般已消失，如还在）

### C.3 彻底禁止

彻底禁止 OneDrive 重新出现（很关键）

- 启动 组策略（专业版 / 企业版）`gpedit.msc`

    ```
    计算机配置
    → 管理模板
    → Windows 组件
    → OneDrive
    ```

- 启用：

    ```
    禁止使用 OneDrive 进行文件存储
    ```

- 注册表（家庭版可用）

    ```
    reg add "HKLM\Software\Policies\Microsoft\Windows\OneDrive" /v DisableFileSyncNGSC /t REG_DWORD /d 1 /f
    ```







## 补充

### 1. 虚拟内存

虚拟内存别乱动（很多人会搞错），保持“系统管理”反而更省内存。